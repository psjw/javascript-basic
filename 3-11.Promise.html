<!DOCTYPE html>
<html>

<head>
    <title>Document</title>
</head>

<body>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        //Promise
        //

        //순차적 실행
        var x = 1;

        //서버 호출해서 데이터를 받아오는 함수 구현.
        //서버에서 받아오기 전에 아래 스크립트 실행
        //y = callServerData();
        //서버로부터 데이터 오기전에 아래 코드 실행
        //var z = x + y;

        //axios
        var url = "https://d3b7c204-579d-458d-b013-6f8eb4087f46.mock.pstmn.io/productList";
        //배열을 받아오면 price에 금액
        var data = axios.get(url).then(function (response) {
            console.log(response.data);
            return response.data;
        });

        var total = 0;
        //에러 발생  3-11.Promise.html:32 Uncaught TypeError: data is not iterable
        //먼저 수행 되버림
        //for (var item of data) {
        //    total += item.price;
        //}


        function getData() {
            //promise
            //resolve 성공시 사용, reject 실패시 사용 (중단시킴)
            return new Promise(function (resolve, reject) {
                axios.get(url).then(function (response) {
                    console.log(response.data);
                    resolve(response.data); //resolve에 있는값을 return
                });
            });
        }

        var total1 = 0;
        getData().then(function (data) {
            console.log("##", data);
            for (var item of data.products) {
                total1 += item.price;
            }
            console.log("total1",total1);
        });

        var userUrl = "https://d3b7c204-579d-458d-b013-6f8eb4087f46.mock.pstmn.io/userList";

        function getUserList() {
            return new Promise((resolve, reject) => {
                axios.get(userUrl).then((response) => {
                    console.log("!!!",response.data);
                    resolve(response.data);
                });
            });

        }

        getUserList().then((data) => {
            console.log("#########",data);
            for(item of data.userList){
                console.log("userList",item.name);
            }
        });
    </script>
</body>

</html>